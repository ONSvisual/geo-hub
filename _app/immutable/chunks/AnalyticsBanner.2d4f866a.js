import{S as pe,i as fe,s as me,e as re,b as F,D as K,h as _,Q as he,o as ye,k as w,l as C,m as T,n as k,C as p,q as I,r as z,G as J,u as ve,a as L,c as V,H as ne,J as ge}from"./index.556ea14b.js";import{p as oe}from"./stores.bc93b5b3.js";var ae={},M={},B=34,P=10,Y=13;function ue(t){return new Function("d","return {"+t.map(function(r,e){return JSON.stringify(r)+": d["+e+'] || ""'}).join(",")+"}")}function be(t,r){var e=ue(t);return function(o,n){return r(e(o),n,t)}}function se(t){var r=Object.create(null),e=[];return t.forEach(function(o){for(var n in o)n in r||e.push(r[n]=n)}),e}function W(t,r){var e=t+"",o=e.length;return o<r?new Array(r-o+1).join(0)+e:e}function ke(t){return t<0?"-"+W(-t,6):t>9999?"+"+W(t,6):W(t,4)}function _e(t){var r=t.getUTCHours(),e=t.getUTCMinutes(),o=t.getUTCSeconds(),n=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":ke(t.getUTCFullYear())+"-"+W(t.getUTCMonth()+1,2)+"-"+W(t.getUTCDate(),2)+(n?"T"+W(r,2)+":"+W(e,2)+":"+W(o,2)+"."+W(n,3)+"Z":o?"T"+W(r,2)+":"+W(e,2)+":"+W(o,2)+"Z":e||r?"T"+W(r,2)+":"+W(e,2)+"Z":"")}function Ee(t){var r=new RegExp('["'+t+`
\r]`),e=t.charCodeAt(0);function o(a,i){var f,m,h=n(a,function(u,b){if(f)return f(u,b-1);m=u,f=i?be(u,i):ue(u)});return h.columns=m||[],h}function n(a,i){var f=[],m=a.length,h=0,u=0,b,j=m<=0,y=!1;a.charCodeAt(m-1)===P&&--m,a.charCodeAt(m-1)===Y&&--m;function N(){if(j)return M;if(y)return y=!1,ae;var A,S=h,D;if(a.charCodeAt(S)===B){for(;h++<m&&a.charCodeAt(h)!==B||a.charCodeAt(++h)===B;);return(A=h)>=m?j=!0:(D=a.charCodeAt(h++))===P?y=!0:D===Y&&(y=!0,a.charCodeAt(h)===P&&++h),a.slice(S+1,A-1).replace(/""/g,'"')}for(;h<m;){if((D=a.charCodeAt(A=h++))===P)y=!0;else if(D===Y)y=!0,a.charCodeAt(h)===P&&++h;else if(D!==e)continue;return a.slice(S,A)}return j=!0,a.slice(S,m)}for(;(b=N())!==M;){for(var E=[];b!==ae&&b!==M;)E.push(b),b=N();i&&(E=i(E,u++))==null||f.push(E)}return f}function s(a,i){return a.map(function(f){return i.map(function(m){return l(f[m])}).join(t)})}function c(a,i){return i==null&&(i=se(a)),[i.map(l).join(t)].concat(s(a,i)).join(`
`)}function d(a,i){return i==null&&(i=se(a)),s(a,i).join(`
`)}function g(a){return a.map(v).join(`
`)}function v(a){return a.map(l).join(t)}function l(a){return a==null?"":a instanceof Date?_e(a):r.test(a+="")?'"'+a.replace(/"/g,'""')+'"':a}return{parse:o,parseRows:n,format:c,formatBody:d,formatRows:g,formatRow:v,formatValue:l}}var we=Ee(","),Ce=we.parse;function Te(t){for(var r in t){var e=t[r].trim(),o,n;if(!e)e=null;else if(e==="true")e=!0;else if(e==="false")e=!1;else if(e==="NaN")e=NaN;else if(!isNaN(o=+e))e=o;else if(n=e.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))je&&n[4]&&!n[7]&&(e=e.replace(/-/g,"/").replace(/T/," ")),e=new Date(e);else continue;t[r]=e}return t}const je=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Se(t){return t}function Ae(t){if(t==null)return Se;var r,e,o=t.scale[0],n=t.scale[1],s=t.translate[0],c=t.translate[1];return function(d,g){g||(r=e=0);var v=2,l=d.length,a=new Array(l);for(a[0]=(r+=d[0])*o+s,a[1]=(e+=d[1])*n+c;v<l;)a[v]=d[v],++v;return a}}function We(t,r){for(var e,o=t.length,n=o-r;n<--o;)e=t[n],t[n++]=t[o],t[o]=e}function Ne(t,r){return typeof r=="string"&&(r=t.objects[r]),r.type==="GeometryCollection"?{type:"FeatureCollection",features:r.geometries.map(function(e){return ie(t,e)})}:ie(t,r)}function ie(t,r){var e=r.id,o=r.bbox,n=r.properties==null?{}:r.properties,s=Ie(t,r);return e==null&&o==null?{type:"Feature",properties:n,geometry:s}:o==null?{type:"Feature",id:e,properties:n,geometry:s}:{type:"Feature",id:e,bbox:o,properties:n,geometry:s}}function Ie(t,r){var e=Ae(t.transform),o=t.arcs;function n(l,a){a.length&&a.pop();for(var i=o[l<0?~l:l],f=0,m=i.length;f<m;++f)a.push(e(i[f],f));l<0&&We(a,m)}function s(l){return e(l)}function c(l){for(var a=[],i=0,f=l.length;i<f;++i)n(l[i],a);return a.length<2&&a.push(a[0]),a}function d(l){for(var a=c(l);a.length<4;)a.push(a[0]);return a}function g(l){return l.map(d)}function v(l){var a=l.type,i;switch(a){case"GeometryCollection":return{type:a,geometries:l.geometries.map(v)};case"Point":i=s(l.coordinates);break;case"MultiPoint":i=l.coordinates.map(s);break;case"LineString":i=c(l.arcs);break;case"MultiLineString":i=l.arcs.map(c);break;case"Polygon":i=g(l.arcs);break;case"MultiPolygon":i=l.arcs.map(g);break;default:return null}return{type:a,coordinates:i}}return v(r)}const Ke="https://www.ons.gov.uk/visualisations/areas",ze="https://ons-dp-prod-cdn.s3.eu-west-2.amazonaws.com/maptiles/ap-geos/v2",De={W04:{label:"community",plural:"communities",childGroup:!0},E06:{label:"unitary authority",plural:"unitary authorities"},W06:{label:"unitary authority",plural:"unitary authorities",childGroup:!0},E07:{label:"non-metropolitan district",plural:"non-metropolitan districts",childGroup:!0},E08:{label:"metropolitan district",plural:"metropolitan districts"},E09:{label:"borough",plural:"boroughs",childGroup:!0},E10:{label:"county",plural:"counties"},E11:{label:"metropolitan county",plural:"metropolital counties"},S12:{label:"council area",plural:"council areas",childGroup:!0},N09:{label:"local government district",plural:"local government districts",childGroup:!0}},Oe=["E00","W00","E01","W01","E02","W02","E04","W04","E05","W05"],Pe=[{id:"uk",type:"geojson"},{id:"ctry",type:"geojson"},{id:"rgn",type:"geojson"},{id:"la",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2023/authorities-all/v1/boundaries/{z}/{x}/{y}.pbf",layer:"boundaries",minzoom:4},{id:"wpc",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2010/wpc/v2/boundaries/{z}/{x}/{y}.pbf",layer:"boundaries",minzoom:4},{id:"sener",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2022/sen/v1/boundaries/{z}/{x}/{y}.pbf",layer:"region"},{id:"senc",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2022/sen/v1/boundaries/{z}/{x}/{y}.pbf",layer:"constituency"},{id:"wd",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2022/wd/v1/boundaries/{z}/{x}/{y}.pbf",layer:"wd",minzoom:6},{id:"par",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2022/par/v1/boundaries/{z}/{x}/{y}.pbf",layer:"par",minzoom:6},{id:"msoa",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/msoa/v2/boundaries/{z}/{x}/{y}.pbf",layer:"msoa",minzoom:6},{id:"lsoa",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/lsoa/v2/boundaries/{z}/{x}/{y}.pbf",layer:"lsoa",minzoom:7},{id:"oa",type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/oa/v2/boundaries/{z}/{x}/{y}.pbf",layer:"oa",minzoom:8}],H=t=>t.map(r=>["!",["in",r,["get","areacd"]]]),G=[{key:"uk",codes:["K02"],source:"uk"},{key:"ctry",codes:["E92","S92","N92","W92"],pcio:"country",label:"country",plural:"countries",source:"ctry"},{key:"rgn",codes:["E12"],pcio:"region",label:"region",plural:"regions",source:"rgn"},{key:"cauth",codes:["E06","E09","E10","E47","N09","S12","W06"],label:"upper-tier/combined authority",plural:"upper-tier/combined authorities",source:"la",filter:["all",...H(["E07","E08"]),["!",["==",["get","cauth"],"true"]]]},{key:"utla",codes:["E06","E08","E09","E10","N09","S12","W06"],pcio:"admin_county",label:"upper-tier/unitary authority",plural:"upper-tier/unitary authorities",source:"la",filter:["all",...H(["E07","E47"])]},{key:"ltla",codes:["E06","E07","E08","E09","N09","S12","W06"],pcio:"admin_district",label:"lower-tier/unitary authority",plural:"lower-tier/unitary authorities",source:"la",filter:["all",...H(["E10","E47"])]},{key:"wpc",codes:["E14","N06","S14","W07"],pcio:"parliamentary_constituency",label:"parliamentary constituency",plural:"parliamentary constituencies",source:"wpc"},{key:"sener",codes:["W10"],label:"Senedd electoral region",plural:"Senedd electoral regions",source:"sener"},{key:"senc",codes:["W09"],label:"Senedd constituency",plural:"Senedd constituencies",source:"senc"},{key:"wd",codes:["E05","W05"],pcio:"admin_ward",label:"ward",plural:"wards",source:"wd"},{key:"par",codes:["E04","W04"],pcio:"parish",label:"parish",plural:"parishes",source:"par"},{key:"msoa",codes:["E02","W02"],pcio:"msoa",label:"MSOA",plural:"MSOAs",source:"msoa"},{key:"lsoa",codes:["E01","W01"],pcio:"lsoa",label:"LSOA",plural:"LSOAs",source:"lsoa"},{key:"oa",codes:["E00","W00"],label:"output area",plural:"output areas",source:"oa"}],Je=Pe.map(t=>({...t,layers:G.filter(r=>r.source===t.id)})),x=(()=>{let t={};return G.forEach(r=>r.codes.forEach(e=>{t[e]={...r};const o=De[e];o!=null&&o.childGroup&&(t[e].label=o.label,t[e].plural=o.plural)})),t})();(()=>{let t={};return G.forEach(r=>t[r.key]=r),t})();const Re=(t,r=Te)=>Ce(t.replace(/\uFEFF/,""),r);async function Ze(t,r=window.fetch){let o=await(await r(t)).text(),n=Re(o),s=n.columns.filter(c=>{n[0][c]&&String(n[0][c]).includes("|")});return n.forEach((c,d)=>{s.forEach(g=>{c[g]=c[g].split("|")})}),n}function Ue(t){let r=Array.from(new Set(t.sort((n,s)=>n.localeCompare(s)).map(n=>x[n]))).filter((n,s,c)=>c.map(d=>d.key).indexOf(n.key)===s);const e=["cauth","utla","ltla"].filter(n=>r.map(s=>s.key).includes(n));e.length>1&&(r=r.filter(n=>!e.slice(1).includes(n.key)));const o=G.map(n=>n.key);return r.sort((n,s)=>o.indexOf(n.key)-o.indexOf(s.key))}async function qe(t,r=window.fetch){try{let e=t.slice(0,3),n=await(await r(`${ze}/${e}/${t}.json`)).json();return n.properties.childTypes=Ue(n.properties.child_typecds),{place:n.properties,type:x[e],geometry:n.properties.end?n.geometry:null}}catch(e){return console.debug(e),{place:null,type:null}}}function Le(t,r=null){let e=t.hclnm?t.hclnm:t.areanm?t.areanm:t.areacd,o=e.startsWith("Isle"),n=["E12000001","E12000002","E12000004","E12000005","E12000006","E12000008","E12000009","E09000001","E07000035"].includes(t.areacd)||e.startsWith("Vale of");return e=e.replace("&","and").replace(", City of","").replace(", County of",""),["in","the"].includes(r)&&(o||n)&&(e="the "+e),r==="in"&&(o?e="on "+e:e="in "+e),e}const de=(t,r)=>!r||(!t.start||r>t.start)&&(!t.end||r<=t.end);function le(t,r){var o;const e=[...r.parents];["E","W"].includes(r.areacd[0])&&e.push({areacd:"K04000001",areanm:"England and Wales"}),console.log(e);for(const n of e){let s=n.areacd.slice(0,3);if(t.geocodes.includes(s)&&de(n,t.year))return n.groupcd=(o=x[s])!=null&&o.key?x[s].key:"ew",n}return null}function Qe(t,r){console.log(t,r);let e=[],o=[];return t.forEach(n=>{let s=le(n,r);n.geocodes.includes(r.typecd)&&de(r,n.year)?e.push({...n,place:r}):s&&o.push({...n,place:le(n,r)})}),[...e,...o]}function Xe(t,r){let e=t,o=t.match(new RegExp(/\{(.*?)\}/g));return Array.isArray(o)&&o.forEach(n=>{if(n.includes("name")){let s=n.slice(1,-1).split(",")[1];e=e.replace(n,`<strong>${Le(r,s)}</strong>`)}else e=e.replace(n,r[n.slice(1,-1)])}),e}function $e(t){return Oe.includes(t.slice(0,3))?"area/?code="+t:t+"/"}function et(t,r){const e=r.key==="msoa"?"hclnm":r.key==="oa"?"areacd":"areanm";return t.children.filter(o=>r.codes.includes(o.areacd.slice(0,3))).sort((o,n)=>o[e].localeCompare(n[e]))}function tt(t,r){return Ne(t,r)}function rt(t){return t[0].toUpperCase()+t.slice(1)}function ce(t){let r,e;function o(c,d){return c[1]?Ve:xe}let n=o(t),s=n(t);return{c(){r=w("section"),e=w("form"),s.c(),this.h()},l(c){r=C(c,"SECTION",{});var d=T(r);e=C(d,"FORM",{id:!0,class:!0,"aria-label":!0});var g=T(e);s.l(g),g.forEach(_),d.forEach(_),this.h()},h(){k(e,"id","global-cookie-message"),k(e,"class","cookies-banner clearfix svelte-nl7vav"),k(e,"aria-label","cookie banner")},m(c,d){F(c,r,d),p(r,e),s.m(e,null)},p(c,d){n===(n=o(c))&&s?s.p(c,d):(s.d(1),s=n(c),s&&(s.c(),s.m(e,null)))},d(c){c&&_(r),s.d()}}}function Ve(t){let r,e,o,n,s,c,d,g,v,l,a,i,f,m,h;return{c(){r=w("div"),e=w("div"),o=w("div"),n=w("div"),s=w("p"),c=I("You’ve accepted "),d=I(t[2]),g=I(` cookies. You can
              `),v=w("a"),l=I("change your cookie settings"),a=I(`
              at any time.
              `),i=w("button"),f=I("Hide"),this.h()},l(u){r=C(u,"DIV",{});var b=T(r);e=C(b,"DIV",{class:!0});var j=T(e);o=C(j,"DIV",{class:!0});var y=T(o);n=C(y,"DIV",{class:!0});var N=T(n);s=C(N,"P",{class:!0});var E=T(s);c=z(E,"You’ve accepted "),d=z(E,t[2]),g=z(E,` cookies. You can
              `),v=C(E,"A",{href:!0,class:!0});var A=T(v);l=z(A,"change your cookie settings"),A.forEach(_),a=z(E,`
              at any time.
              `),i=C(E,"BUTTON",{type:!0,class:!0});var S=T(i);f=z(S,"Hide"),S.forEach(_),E.forEach(_),N.forEach(_),y.forEach(_),j.forEach(_),b.forEach(_),this.h()},h(){k(v,"href","/cookies"),k(v,"class","svelte-nl7vav"),k(i,"type","button"),k(i,"class","cookies-banner__button--hide svelte-nl7vav"),k(s,"class","cookies-banner__confirmation-message svelte-nl7vav"),k(n,"class","cookies-banner__message font-size--18 svelte-nl7vav"),k(o,"class","col svelte-nl7vav"),k(e,"class","cookies-banner__wrapper wrapper svelte-nl7vav")},m(u,b){F(u,r,b),p(r,e),p(e,o),p(o,n),p(n,s),p(s,c),p(s,d),p(s,g),p(s,v),p(v,l),p(s,a),p(s,i),p(i,f),m||(h=J(i,"click",t[9]),m=!0)},p(u,b){b&4&&ve(d,u[2])},d(u){u&&_(r),m=!1,h()}}}function xe(t){let r,e,o,n,s,c,d,g,v,l,a,i,f,m,h,u,b,j,y,N,E,A;return{c(){r=w("div"),e=w("div"),o=w("div"),n=w("h1"),s=I("Tell us whether you accept cookies"),c=L(),d=w("p"),g=I(`We would like to
            use cookies to collect anonymous information
            about how you use this prototype.`),v=L(),l=w("p"),a=I("We use this information to improve our services."),i=L(),f=w("div"),m=w("div"),h=w("button"),u=I("Accept cookies"),b=L(),j=w("div"),y=w("button"),N=I("Reject cookies"),this.h()},l(S){r=C(S,"DIV",{class:!0});var D=T(r);e=C(D,"DIV",{});var R=T(e);o=C(R,"DIV",{class:!0});var O=T(o);n=C(O,"H1",{class:!0});var Z=T(n);s=z(Z,"Tell us whether you accept cookies"),Z.forEach(_),c=V(O),d=C(O,"P",{class:!0});var q=T(d);g=z(q,`We would like to
            use cookies to collect anonymous information
            about how you use this prototype.`),q.forEach(_),v=V(O),l=C(O,"P",{class:!0});var Q=T(l);a=z(Q,"We use this information to improve our services."),Q.forEach(_),O.forEach(_),i=V(R),f=C(R,"DIV",{class:!0});var U=T(f);m=C(U,"DIV",{class:!0});var X=T(m);h=C(X,"BUTTON",{class:!0,"data-gtm-accept-cookies":!0,type:!0});var $=T(h);u=z($,"Accept cookies"),$.forEach(_),X.forEach(_),b=V(U),j=C(U,"DIV",{class:!0});var ee=T(j);y=C(ee,"BUTTON",{class:!0,"data-gtm-accept-cookies":!0});var te=T(y);N=z(te,"Reject cookies"),te.forEach(_),ee.forEach(_),U.forEach(_),R.forEach(_),D.forEach(_),this.h()},h(){k(n,"class","cookies-banner__heading font-size--h3 svelte-nl7vav"),k(d,"class","cookies-banner__body svelte-nl7vav"),k(l,"class","cookies-banner__body svelte-nl7vav"),k(o,"class","cookies-banner__message font-size--18 svelte-nl7vav"),k(h,"class","btn btn--full-width btn--primary btn--focus margin-right--2 font-weight-700 font-size--17 text-wrap svelte-nl7vav"),k(h,"data-gtm-accept-cookies","true"),k(h,"type","submit"),k(m,"class","cookies-banner__button cookies-banner__button--accept svelte-nl7vav"),k(y,"class","btn btn--full-width btn--secondary btn--focus font-weight-700 font-size--17 text-wrap svelte-nl7vav"),k(y,"data-gtm-accept-cookies","true"),k(j,"class","cookies-banner__button svelte-nl7vav"),k(f,"class","cookies-banner__buttons svelte-nl7vav"),k(r,"class","cookies-banner__wrapper wrapper svelte-nl7vav")},m(S,D){F(S,r,D),p(r,e),p(e,o),p(o,n),p(n,s),p(o,c),p(o,d),p(d,g),p(o,v),p(o,l),p(l,a),p(e,i),p(e,f),p(f,m),p(m,h),p(h,u),p(f,b),p(f,j),p(j,y),p(y,N),E||(A=[J(h,"click",ne(t[7])),J(y,"click",ne(t[8]))],E=!0)},p:K,d(S){S&&_(r),E=!1,ge(A)}}}function Fe(t){let r,e=t[0]&&ce(t);return{c(){e&&e.c(),r=re()},l(o){e&&e.l(o),r=re()},m(o,n){e&&e.m(o,n),F(o,r,n)},p(o,[n]){o[0]?e?e.p(o,n):(e=ce(o),e.c(),e.m(r.parentNode,r)):e&&(e.d(1),e=null)},i:K,o:K,d(o){e&&e.d(o),o&&_(r)}}}function nt(t){window.dataLayer&&window.dataLayer.push(t)}function Ge(){return-1<document.cookie.indexOf("cookies_preferences_set=true")}function Me(){var t=document.cookie.match(new RegExp("(^|;) ?cookies_policy=([^;]*)(;|$)"));if(t){var r=decodeURIComponent(t[2]),e=JSON.parse(r);return e.usage}return!1}function Be(t,r,e){let o;he(t,oe,u=>e(12,o=u));let{analyticsId:n}=r,{analyticsProps:s={}}=r,{usageCookies:c=!1}=r,d,g=!1,v=!1,l="";function a(u){let b=31536e3,j=window.location.hostname,y=!0,N=`%7B%22essential%22%3Atrue%2C%22usage%22%3A${u=="all"?"true":"false"}%7D`,E="/";document.cookie=`cookies_preferences_set=${y};max-age=${b};domain=${j};path=${E};`,document.cookie=`cookies_policy=${N};max-age=${b};domain=${j};path=${E};`,e(2,l=u=="all"?"all":"only essential"),u=="all"&&e(4,c=!0),e(1,v=!0),u=="all"&&i()}function i(){console.log("initialising analytics"),window.dataLayer=[{analyticsOptOut:!1,"gtm.whitelist":["google","hjtc","lcl"],"gtm.blacklist":["customScripts","sp","adm","awct","k","d","j"],...s}],oe&&o.url.href,function(u,b,j,y,N){u[y]=u[y]||[],u[y].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var E=b.head,A=b.createElement(j),S=y!="dataLayer"?"&l="+y:"";A.async=!0,A.src="https://www.googletagmanager.com/gtm.js?id="+N+S,E.appendChild(A)}(window,document,"script","dataLayer",n)}ye(()=>{d=!0,e(0,g=!Ge()),e(4,c=Me()),c&&d&&i()});const f=()=>a("all"),m=()=>a("reject"),h=()=>e(0,g=!1);return t.$$set=u=>{"analyticsId"in u&&e(5,n=u.analyticsId),"analyticsProps"in u&&e(6,s=u.analyticsProps),"usageCookies"in u&&e(4,c=u.usageCookies)},[g,v,l,a,c,n,s,f,m,h]}class ot extends pe{constructor(r){super(),fe(this,r,Be,Fe,me,{analyticsId:5,analyticsProps:6,usageCookies:4})}}export{ot as A,Ke as a,nt as b,x as c,qe as d,Je as e,Qe as f,Ze as g,tt as h,et as i,rt as j,G as k,De as l,$e as m,Oe as n,Xe as p};
