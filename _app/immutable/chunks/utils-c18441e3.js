var F={},v={},R=34,E=10,U=13;function k(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function I(e,t){var n=k(e);return function(a,i){return t(n(a),i,e)}}function M(e){var t=Object.create(null),n=[];return e.forEach(function(a){for(var i in a)i in t||n.push(t[i]=i)}),n}function p(e,t){var n=e+"",a=n.length;return a<t?new Array(t-a+1).join(0)+n:n}function L(e){return e<0?"-"+p(-e,6):e>9999?"+"+p(e,6):p(e,4)}function O(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),a=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":L(e.getUTCFullYear())+"-"+p(e.getUTCMonth()+1,2)+"-"+p(e.getUTCDate(),2)+(i?"T"+p(t,2)+":"+p(n,2)+":"+p(a,2)+"."+p(i,3)+"Z":a?"T"+p(t,2)+":"+p(n,2)+":"+p(a,2)+"Z":n||t?"T"+p(t,2)+":"+p(n,2)+"Z":"")}function S(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function a(r,o){var s,c,l=i(r,function(y,C){if(s)return s(y,C-1);c=y,s=o?I(y,o):k(y)});return l.columns=c||[],l}function i(r,o){var s=[],c=r.length,l=0,y=0,C,b=c<=0,w=!1;r.charCodeAt(c-1)===E&&--c,r.charCodeAt(c-1)===U&&--c;function D(){if(b)return v;if(w)return w=!1,F;var A,N=l,T;if(r.charCodeAt(N)===R){for(;l++<c&&r.charCodeAt(l)!==R||r.charCodeAt(++l)===R;);return(A=l)>=c?b=!0:(T=r.charCodeAt(l++))===E?w=!0:T===U&&(w=!0,r.charCodeAt(l)===E&&++l),r.slice(N+1,A-1).replace(/""/g,'"')}for(;l<c;){if((T=r.charCodeAt(A=l++))===E)w=!0;else if(T===U)w=!0,r.charCodeAt(l)===E&&++l;else if(T!==n)continue;return r.slice(N,A)}return b=!0,r.slice(N,c)}for(;(C=D())!==v;){for(var j=[];C!==F&&C!==v;)j.push(C),C=D();o&&(j=o(j,y++))==null||s.push(j)}return s}function f(r,o){return r.map(function(s){return o.map(function(c){return u(s[c])}).join(e)})}function d(r,o){return o==null&&(o=M(r)),[o.map(u).join(e)].concat(f(r,o)).join(`
`)}function g(r,o){return o==null&&(o=M(r)),f(r,o).join(`
`)}function m(r){return r.map(h).join(`
`)}function h(r){return r.map(u).join(e)}function u(r){return r==null?"":r instanceof Date?O(r):t.test(r+="")?'"'+r.replace(/"/g,'""')+'"':r}return{parse:a,parseRows:i,format:d,formatBody:g,formatRows:m,formatRow:h,formatValue:u}}var Z=S(","),B=Z.parse;function G(e){for(var t in e){var n=e[t].trim(),a,i;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(a=+n))n=a;else if(i=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))H&&!!i[4]&&!i[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;e[t]=n}return e}const H=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function W(e){return e}function J(e){if(e==null)return W;var t,n,a=e.scale[0],i=e.scale[1],f=e.translate[0],d=e.translate[1];return function(g,m){m||(t=n=0);var h=2,u=g.length,r=new Array(u);for(r[0]=(t+=g[0])*a+f,r[1]=(n+=g[1])*i+d;h<u;)r[h]=g[h],++h;return r}}function V(e,t){for(var n,a=e.length,i=a-t;i<--a;)n=e[i],e[i++]=e[a],e[a]=n}function Y(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return P(e,n)})}:P(e,t)}function P(e,t){var n=t.id,a=t.bbox,i=t.properties==null?{}:t.properties,f=$(e,t);return n==null&&a==null?{type:"Feature",properties:i,geometry:f}:a==null?{type:"Feature",id:n,properties:i,geometry:f}:{type:"Feature",id:n,bbox:a,properties:i,geometry:f}}function $(e,t){var n=J(e.transform),a=e.arcs;function i(u,r){r.length&&r.pop();for(var o=a[u<0?~u:u],s=0,c=o.length;s<c;++s)r.push(n(o[s],s));u<0&&V(r,c)}function f(u){return n(u)}function d(u){for(var r=[],o=0,s=u.length;o<s;++o)i(u[o],r);return r.length<2&&r.push(r[0]),r}function g(u){for(var r=d(u);r.length<4;)r.push(r[0]);return r}function m(u){return u.map(g)}function h(u){var r=u.type,o;switch(r){case"GeometryCollection":return{type:r,geometries:u.geometries.map(h)};case"Point":o=f(u.coordinates);break;case"MultiPoint":o=u.coordinates.map(f);break;case"LineString":o=d(u.arcs);break;case"MultiLineString":o=u.arcs.map(d);break;case"Polygon":o=m(u.arcs);break;case"MultiPolygon":o=u.arcs.map(m);break;default:return null}return{type:r,coordinates:o}}return h(t)}async function Q(e,t=window.fetch){let a=await(await t(e)).text(),i=B(a,G),f=i.columns.filter(d=>i[0][d].includes("|"));return i.forEach((d,g)=>{f.forEach(m=>{d[m]=d[m].split("|")})}),i}function z(e,t=null){let n=e.hclnm?e.hclnm:e.areanm?e.areanm:e.areacd,a=n.startsWith("Isle"),i=e.areacd.slice(0,3)==="E12"&&!["E12000003","E12000007"].includes(e.areacd);return n=n.replace("&","and"),["in","the"].includes(t)&&(a||i)&&(n="the "+n),t==="in"&&(a?n="on "+n:n="in "+n),n}function q(e,t){for(const n of t)if(e.includes(n.areacd.slice(0,3)))return[n];return[]}function K(e,t){let n=e,a=e.match(new RegExp(/\{(.*?)\}/g));return Array.isArray(a)&&a.forEach(i=>{if(i.includes("name")){let f=i.slice(1,-1).split(",")[1];n=n.replace(i,z(t,f))}else n=n.replace(i,t[i.slice(1,-1)])}),n}function X(e){return!e.startsWith("unit")&&["a","e","i","o","u"].includes(e.slice(0,1).toLowerCase())?"an "+e:"a "+e}function _(e,t){return Y(e,t)}function x(e){return e[0].toUpperCase()+e.slice(1)}export{z as a,X as b,x as c,q as d,Q as g,_ as m,K as p};
