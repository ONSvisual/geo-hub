const X="https://www.ons.gov.uk/visualisations/areas",P="https://cdn.ons.gov.uk/maptiles/ap-geos/v1",I={E06:{label:"unitary authority",plural:"unitary authorities"},W06:{label:"unitary authority",plural:"unitary authorities"},E07:{label:"non-metropolitan district",plural:"non-metropolitan districts"},E08:{label:"metropolitan district",plural:"metropolitan districts"},E09:{label:"borough",plural:"boroughs"},E10:{label:"county",plural:"counties"},E11:{label:"metropolitan county",plural:"metropolital counties"}},U=[{key:"ew",codes:["K04"],source:{type:"geojson",promoteId:"areacd"}},{key:"ctry",codes:["E92","W92"],pcio:"country",label:"country",plural:"countries",source:{type:"geojson",promoteId:"areacd"}},{key:"rgn",codes:["E12"],pcio:"region",label:"region",plural:"regions",source:{type:"geojson",promoteId:"areacd"}},{key:"cty",codes:["E10","E11","E06","W06","E09"],pcio:"admin_county",label:"county/unitary authority",plural:"counties/unitary authorities",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/cty/v1/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:4}},{key:"lad",codes:["E06","E07","E08","E09","W06"],pcio:"admin_district",label:"district",plural:"districts",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/authorities-ew/v2/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:4}},{key:"wpc",codes:["E14","W07"],pcio:"parliamentary_constituency",label:"parliamentary constituency",plural:"parliamentary constituencies",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2010/wpc/v1/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:4}},{key:"wd",codes:["E05","W05"],pcio:"admin_ward",label:"ward",plural:"wards",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2022/wd/v1/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:6}},{key:"par",codes:["E04","W04"],pcio:"parish",label:"parish",plural:"parishes",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2022/par/v1/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:6}},{key:"msoa",codes:["E02","W02"],pcio:"msoa",label:"MSOA",plural:"MSOAs",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/msoa/v2/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:6}},{key:"lsoa",codes:["E01","W01"],pcio:"lsoa",label:"LSOA",plural:"LSOAs",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/lsoa/v2/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:7}},{key:"oa",codes:["E00","W00"],label:"output area",plural:"output areas",source:{type:"vector",url:"https://cdn.ons.gov.uk/maptiles/administrative/2021/oa/v2/boundaries/{z}/{x}/{y}.pbf",promoteId:"areacd",minzoom:8}}],S=(()=>{let e={};return U.forEach(r=>r.codes.forEach(t=>e[t]=r)),e})();(()=>{let e={};return U.forEach(r=>e[r.key]=r),e})();const ee={England:"E92000001",Wales:"W92000004","North East":"E12000001","North West":"E12000002","Yorkshire and The Humber":"E12000003","East Midlands":"E12000004","West Midlands":"E12000005","East of England":"E12000006",London:"E12000007","South East":"E12000008","South West":"E12000009"};var L={},j={},W=34,w=10,N=13;function D(e){return new Function("d","return {"+e.map(function(r,t){return JSON.stringify(r)+": d["+t+'] || ""'}).join(",")+"}")}function F(e,r){var t=D(e);return function(a,o){return r(t(a),o,e)}}function O(e){var r=Object.create(null),t=[];return e.forEach(function(a){for(var o in a)o in r||t.push(r[o]=o)}),t}function f(e,r){var t=e+"",a=t.length;return a<r?new Array(r-a+1).join(0)+t:t}function x(e){return e<0?"-"+f(-e,6):e>9999?"+"+f(e,6):f(e,4)}function $(e){var r=e.getUTCHours(),t=e.getUTCMinutes(),a=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":x(e.getUTCFullYear())+"-"+f(e.getUTCMonth()+1,2)+"-"+f(e.getUTCDate(),2)+(o?"T"+f(r,2)+":"+f(t,2)+":"+f(a,2)+"."+f(o,3)+"Z":a?"T"+f(r,2)+":"+f(t,2)+":"+f(a,2)+"Z":t||r?"T"+f(r,2)+":"+f(t,2)+"Z":"")}function H(e){var r=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function a(n,i){var p,c,d=o(n,function(g,E){if(p)return p(g,E-1);c=g,p=i?F(g,i):D(g)});return d.columns=c||[],d}function o(n,i){var p=[],c=n.length,d=0,g=0,E,T=c<=0,b=!1;n.charCodeAt(c-1)===w&&--c,n.charCodeAt(c-1)===N&&--c;function z(){if(T)return j;if(b)return b=!1,L;var C,A=d,v;if(n.charCodeAt(A)===W){for(;d++<c&&n.charCodeAt(d)!==W||n.charCodeAt(++d)===W;);return(C=d)>=c?T=!0:(v=n.charCodeAt(d++))===w?b=!0:v===N&&(b=!0,n.charCodeAt(d)===w&&++d),n.slice(A+1,C-1).replace(/""/g,'"')}for(;d<c;){if((v=n.charCodeAt(C=d++))===w)b=!0;else if(v===N)b=!0,n.charCodeAt(d)===w&&++d;else if(v!==t)continue;return n.slice(A,C)}return T=!0,n.slice(A,c)}for(;(E=z())!==j;){for(var k=[];E!==L&&E!==j;)k.push(E),E=z();i&&(k=i(k,g++))==null||p.push(k)}return p}function u(n,i){return n.map(function(p){return i.map(function(c){return s(p[c])}).join(e)})}function l(n,i){return i==null&&(i=O(n)),[i.map(s).join(e)].concat(u(n,i)).join(`
`)}function y(n,i){return i==null&&(i=O(n)),u(n,i).join(`
`)}function h(n){return n.map(m).join(`
`)}function m(n){return n.map(s).join(e)}function s(n){return n==null?"":n instanceof Date?$(n):r.test(n+="")?'"'+n.replace(/"/g,'""')+'"':n}return{parse:a,parseRows:o,format:l,formatBody:y,formatRows:h,formatRow:m,formatValue:s}}var Z=H(","),_=Z.parse;function B(e){for(var r in e){var t=e[r].trim(),a,o;if(!t)t=null;else if(t==="true")t=!0;else if(t==="false")t=!1;else if(t==="NaN")t=NaN;else if(!isNaN(a=+t))t=a;else if(o=t.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))G&&o[4]&&!o[7]&&(t=t.replace(/-/g,"/").replace(/T/," ")),t=new Date(t);else continue;e[r]=t}return e}const G=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function V(e){return e}function Y(e){if(e==null)return V;var r,t,a=e.scale[0],o=e.scale[1],u=e.translate[0],l=e.translate[1];return function(y,h){h||(r=t=0);var m=2,s=y.length,n=new Array(s);for(n[0]=(r+=y[0])*a+u,n[1]=(t+=y[1])*o+l;m<s;)n[m]=y[m],++m;return n}}function J(e,r){for(var t,a=e.length,o=a-r;o<--a;)t=e[o],e[o++]=e[a],e[a]=t}function K(e,r){return typeof r=="string"&&(r=e.objects[r]),r.type==="GeometryCollection"?{type:"FeatureCollection",features:r.geometries.map(function(t){return M(e,t)})}:M(e,r)}function M(e,r){var t=r.id,a=r.bbox,o=r.properties==null?{}:r.properties,u=Q(e,r);return t==null&&a==null?{type:"Feature",properties:o,geometry:u}:a==null?{type:"Feature",id:t,properties:o,geometry:u}:{type:"Feature",id:t,bbox:a,properties:o,geometry:u}}function Q(e,r){var t=Y(e.transform),a=e.arcs;function o(s,n){n.length&&n.pop();for(var i=a[s<0?~s:s],p=0,c=i.length;p<c;++p)n.push(t(i[p],p));s<0&&J(n,c)}function u(s){return t(s)}function l(s){for(var n=[],i=0,p=s.length;i<p;++i)o(s[i],n);return n.length<2&&n.push(n[0]),n}function y(s){for(var n=l(s);n.length<4;)n.push(n[0]);return n}function h(s){return s.map(y)}function m(s){var n=s.type,i;switch(n){case"GeometryCollection":return{type:n,geometries:s.geometries.map(m)};case"Point":i=u(s.coordinates);break;case"MultiPoint":i=s.coordinates.map(u);break;case"LineString":i=l(s.arcs);break;case"MultiLineString":i=s.arcs.map(l);break;case"Polygon":i=h(s.arcs);break;case"MultiPolygon":i=s.arcs.map(h);break;default:return null}return{type:n,coordinates:i}}return m(r)}async function te(e,r=window.fetch){let a=await(await r(e)).text(),o=_(a,B),u=o.columns.filter(l=>o[0][l]&&o[0][l].includes("|"));return o.forEach((l,y)=>{u.forEach(h=>{l[h]=l[h].split("|")})}),o}async function re(e,r=window.fetch){try{let t=e.slice(0,3),o=await(await r(`${P}/${t}/${e}.json`)).json();I[t]&&(o.properties.typenm=I[t].label);let u=o.properties.children[0]?Array.from(new Set(o.properties.children.map(l=>l.areacd.slice(0,3)))):null;return o.properties.childTypes=u?Array.from(new Set(u.map(l=>S[l]))):[],t==="E12"&&(o.properties.childTypes=o.properties.childTypes.filter(l=>l.key!=="lad"),e==="E12000007"&&(o.properties.childTypes=[{key:"lad",codes:["E09"],label:"borough",plural:"boroughs"},...o.properties.childTypes])),{place:o.properties,type:S[t]}}catch{return{place:null,type:null}}}function q(e,r=null){let t=e.hclnm?e.hclnm:e.areanm?e.areanm:e.areacd,a=t.startsWith("Isle"),o=["E12000001","E12000002","E12000004","E12000005","E12000006","E12000008","E12000009","E09000001","E07000035"].includes(e.areacd)||t.startsWith("Vale of");return t=t.replace("&","and").replace(", City of","").replace(", County of",""),["in","the"].includes(r)&&(a||o)&&(t="the "+t),r==="in"&&(a?t="on "+t:t="in "+t),t}function R(e,r){for(const t of r){let a=t.areacd.slice(0,3);if(e.includes(a))return t.groupcd=S[a].key,t}return null}function ne(e,r){let t=[],a=[];return e.forEach(o=>{let u=R(o.geocodes,r.parents);o.geocodes.includes(r.typecd)?t.push({...o,place:r}):u&&a.push({...o,place:R(o.geocodes,r.parents)})}),[...t,...a]}function oe(e,r){let t=e,a=e.match(new RegExp(/\{(.*?)\}/g));return Array.isArray(a)&&a.forEach(o=>{if(o.includes("name")){let u=o.slice(1,-1).split(",")[1];t=t.replace(o,q(r,u))}else t=t.replace(o,r[o.slice(1,-1)])}),t}function ae(e){return e==="output area"?e="Output Area":e==="lower layer super output area"?e="Lower layer Super Output Area (LSOA)":e==="middle layer super output area"&&(e="Middle layer Super Output Area (MSOA)"),!e.startsWith("unit")&&["a","e","i","o","u"].includes(e[0].toLowerCase())?"an "+e:"a "+e}function ie(e){return["K04","E92","W92","E10","E11","E12","E06","E07","E08","E09","W06"].includes(e.slice(0,3))?e+"/":"area/?code="+e}function se(e,r){return K(e,r)}function ue(e){return e[0].toUpperCase()+e.slice(1)}function le(e){window.dataLayer&&window.dataLayer.push(e)}export{I as a,S as b,ue as c,X as d,U as e,ee as f,te as g,le as h,q as i,re as j,ae as k,ne as l,ie as m,se as n,oe as p};
